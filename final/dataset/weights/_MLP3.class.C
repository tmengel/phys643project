// Class: ReadMLP3
// Automatically generated by MethodBase::MakeClass
//

/* configuration options =====================================================

#GEN -*-*-*-*-*-*-*-*-*-*-*- general info -*-*-*-*-*-*-*-*-*-*-*-

Method         : MLP::MLP3
TMVA Release   : 4.2.1         [262657]
ROOT Release   : 6.24/02       [399362]
Creator        : tmengel
Date           : Tue May  3 03:50:32 2022
Host           : Linux root-ubuntu-2004-1 5.4.0-73-generic #82-Ubuntu SMP Wed Apr 14 17:39:42 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
Dir            : /home/tmengel/phys643/phys643project/final
Training events: 381529
Analysis type  : [Classification]


#OPT -*-*-*-*-*-*-*-*-*-*-*-*- options -*-*-*-*-*-*-*-*-*-*-*-*-

# Set by User:
NCycles: "600" [Number of training cycles]
HiddenLayers: "N,N-1,N+10" [Specification of hidden layer architecture]
NeuronType: "sigmoid" [Neuron activation function type]
V: "False" [Verbose output (short form of "VerbosityLevel" below - overrides the latter one)]
VarTransform: "N" [List of variable transformations performed before training, e.g., "D_Background,P_Signal,G,N_AllClasses" for: "Decorrelation, PCA-transformation, Gaussianisation, Normalisation, each for the given class of events ('AllClasses' denotes all events of all classes, if no class indication is given, 'All' is assumed)"]
H: "True" [Print method-specific help message]
TestRate: "5" [Test for overtraining performed at each #th epochs]
UseRegulator: "True" [Use regulator to avoid over-training]
# Default:
RandomSeed: "1" [Random seed for initial synapse weights (0 means unique seed for each run; default value '1')]
EstimatorType: "CE" [MSE (Mean Square Estimator) for Gaussian Likelihood or CE(Cross-Entropy) for Bernoulli Likelihood]
NeuronInputType: "sum" [Neuron input function type]
VerbosityLevel: "Default" [Verbosity level]
CreateMVAPdfs: "False" [Create PDFs for classifier outputs (signal and background)]
IgnoreNegWeightsInTraining: "False" [Events with negative weights are ignored in the training (but are included for testing and performance evaluation)]
TrainingMethod: "BP" [Train with Back-Propagation (BP), BFGS Algorithm (BFGS), or Genetic Algorithm (GA - slower and worse)]
LearningRate: "2.000000e-02" [ANN learning rate parameter]
DecayRate: "1.000000e-02" [Decay rate for learning parameter]
EpochMonitoring: "False" [Provide epoch-wise monitoring plots according to TestRate (caution: causes big ROOT output file!)]
Sampling: "1.000000e+00" [Only 'Sampling' (randomly selected) events are trained each epoch]
SamplingEpoch: "1.000000e+00" [Sampling is used for the first 'SamplingEpoch' epochs, afterwards, all events are taken for training]
SamplingImportance: "1.000000e+00" [ The sampling weights of events in epochs which successful (worse estimator than before) are multiplied with SamplingImportance, else they are divided.]
SamplingTraining: "True" [The training sample is sampled]
SamplingTesting: "False" [The testing sample is sampled]
ResetStep: "50" [How often BFGS should reset history]
Tau: "3.000000e+00" [LineSearch "size step"]
BPMode: "sequential" [Back-propagation learning mode: sequential or batch]
BatchSize: "-1" [Batch size: number of events/batch, only set if in Batch Mode, -1 for BatchSize=number_of_events]
ConvergenceImprove: "1.000000e-30" [Minimum improvement which counts as improvement (<0 means automatic convergence check is turned off)]
ConvergenceTests: "-1" [Number of steps (without improvement) required for convergence (<0 means automatic convergence check is turned off)]
UpdateLimit: "10000" [Maximum times of regulator update]
CalculateErrors: "False" [Calculates inverse Hessian matrix at the end of the training to be able to calculate the uncertainties of an MVA value]
WeightRange: "1.000000e+00" [Take the events for the estimator calculations from small deviations from the desired value to large deviations only over the weight range]
##


#VAR -*-*-*-*-*-*-*-*-*-*-*-* variables *-*-*-*-*-*-*-*-*-*-*-*-

NVar 12
d0Pt                          d0Pt                          d0Pt                          d0Pt                                                            'F'    [0.00790263805538,99.9529266357]
d0E                           d0E                           d0E                           d0E                                                             'F'    [1.8670412302,78.8557510376]
pionPt                        pionPt                        pionPt                        pionPt                                                          'F'    [0.00137880223338,75.2346725464]
pionE                         pionE                         pionE                         pionE                                                           'F'    [0.139762371778,72.3301239014]
kaonPt                        kaonPt                        kaonPt                        kaonPt                                                          'F'    [0.00976904947311,92.3326873779]
kaonE                         kaonE                         kaonE                         kaonE                                                           'F'    [0.494090646505,75.381477356]
DecayLength                   DecayLength                   DecayLength                   DecayLength                                                     'F'    [3.37924666383e-06,181.935562134]
cosTheta                      cosTheta                      cosTheta                      cosTheta                                                        'F'    [3.84784243579e-06,0.999999940395]
DCA_D0                        DCA_D0                        DCA_D0                        DCA_D0                                                          'F'    [3.32895024258e-06,126.578300476]
DCA_Pion                      DCA_Pion                      DCA_Pion                      DCA_Pion                                                        'F'    [0.00165389641188,1326.87768555]
DCA_Kaon                      DCA_Kaon                      DCA_Kaon                      DCA_Kaon                                                        'F'    [0.00454952009022,1205.23425293]
DCA_piK                       DCA_piK                       DCA_piK                       DCA_piK                                                         'F'    [5.07403183292e-06,329.686035156]
NSpec 6
kaonPhi                       kaonPhi                       kaonPhi                       F                                                               'F'    [-3.14158630371,3.14157962799]
kaonEta                       kaonEta                       kaonEta                       F                                                               'F'    [-6.5009431839,6.89160776138]
pionPhi                       pionPhi                       pionPhi                       F                                                               'F'    [-3.14158821106,3.14155983925]
pionEta                       pionEta                       pionEta                       F                                                               'F'    [-6.05347108841,8.09112930298]
d0Phi                         d0Phi                         d0Phi                         F                                                               'F'    [-3.14159202576,3.14159250259]
d0Eta                         d0Eta                         d0Eta                         F                                                               'F'    [-6.18966054916,6.41668319702]


============================================================================ */

#include <array>
#include <vector>
#include <cmath>
#include <string>
#include <iostream>

#ifndef IClassifierReader__def
#define IClassifierReader__def

class IClassifierReader {

 public:

   // constructor
   IClassifierReader() : fStatusIsClean( true ) {}
   virtual ~IClassifierReader() {}

   // return classifier response
   virtual double GetMvaValue( const std::vector<double>& inputValues ) const = 0;

   // returns classifier status
   bool IsStatusClean() const { return fStatusIsClean; }

 protected:

   bool fStatusIsClean;
};

#endif

class ReadMLP3 : public IClassifierReader {

 public:

   // constructor
   ReadMLP3( std::vector<std::string>& theInputVars )
      : IClassifierReader(),
        fClassName( "ReadMLP3" ),
        fNvars( 12 )
   {
      // the training input variables
      const char* inputVars[] = { "d0Pt", "d0E", "pionPt", "pionE", "kaonPt", "kaonE", "DecayLength", "cosTheta", "DCA_D0", "DCA_Pion", "DCA_Kaon", "DCA_piK" };

      // sanity checks
      if (theInputVars.size() <= 0) {
         std::cout << "Problem in class \"" << fClassName << "\": empty input vector" << std::endl;
         fStatusIsClean = false;
      }

      if (theInputVars.size() != fNvars) {
         std::cout << "Problem in class \"" << fClassName << "\": mismatch in number of input values: "
                   << theInputVars.size() << " != " << fNvars << std::endl;
         fStatusIsClean = false;
      }

      // validate input variables
      for (size_t ivar = 0; ivar < theInputVars.size(); ivar++) {
         if (theInputVars[ivar] != inputVars[ivar]) {
            std::cout << "Problem in class \"" << fClassName << "\": mismatch in input variable names" << std::endl
                      << " for variable [" << ivar << "]: " << theInputVars[ivar].c_str() << " != " << inputVars[ivar] << std::endl;
            fStatusIsClean = false;
         }
      }

      // initialize min and max vectors (for normalisation)
      fVmin[0] = -1;
      fVmax[0] = 1;
      fVmin[1] = -1;
      fVmax[1] = 1;
      fVmin[2] = -1;
      fVmax[2] = 1;
      fVmin[3] = -1;
      fVmax[3] = 1;
      fVmin[4] = -1;
      fVmax[4] = 1;
      fVmin[5] = -1;
      fVmax[5] = 1;
      fVmin[6] = -1;
      fVmax[6] = 1;
      fVmin[7] = -1;
      fVmax[7] = 1;
      fVmin[8] = -1;
      fVmax[8] = 1;
      fVmin[9] = -1;
      fVmax[9] = 1;
      fVmin[10] = -1;
      fVmax[10] = 1;
      fVmin[11] = -1;
      fVmax[11] = 1;

      // initialize input variable types
      fType[0] = 'F';
      fType[1] = 'F';
      fType[2] = 'F';
      fType[3] = 'F';
      fType[4] = 'F';
      fType[5] = 'F';
      fType[6] = 'F';
      fType[7] = 'F';
      fType[8] = 'F';
      fType[9] = 'F';
      fType[10] = 'F';
      fType[11] = 'F';

      // initialize constants
      Initialize();

      // initialize transformation
      InitTransform();
   }

   // destructor
   virtual ~ReadMLP3() {
      Clear(); // method-specific
   }

   // the classifier response
   // "inputValues" is a vector of input values in the same order as the
   // variables given to the constructor
   double GetMvaValue( const std::vector<double>& inputValues ) const override;

 private:

   // method-specific destructor
   void Clear();

   // input variable transformation

   double fOff_1[3][12];
   double fScal_1[3][12];
   void InitTransform_1();
   void Transform_1( std::vector<double> & iv, int sigOrBgd ) const;
   void InitTransform();
   void Transform( std::vector<double> & iv, int sigOrBgd ) const;

   // common member variables
   const char* fClassName;

   const size_t fNvars;
   size_t GetNvar()           const { return fNvars; }
   char   GetType( int ivar ) const { return fType[ivar]; }

   // normalisation of input variables
   double fVmin[12];
   double fVmax[12];
   double NormVariable( double x, double xmin, double xmax ) const {
      // normalise to output range: [-1, 1]
      return 2*(x - xmin)/(xmax - xmin) - 1.0;
   }

   // type of input variable: 'F' or 'I'
   char   fType[12];

   // initialize internal variables
   void Initialize();
   double GetMvaValue__( const std::vector<double>& inputValues ) const;

   // private members (method specific)

   double ActivationFnc(double x) const;
   double OutputActivationFnc(double x) const;

   double fWeightMatrix0to1[13][13];   // weight matrix from layer 0 to 1
   double fWeightMatrix1to2[12][13];   // weight matrix from layer 1 to 2
   double fWeightMatrix2to3[23][12];   // weight matrix from layer 2 to 3
   double fWeightMatrix3to4[1][23];   // weight matrix from layer 3 to 4

};

inline void ReadMLP3::Initialize()
{
   // build network structure
   // weight matrix from layer 0 to 1
   fWeightMatrix0to1[0][0] = -1.11446259262077;
   fWeightMatrix0to1[1][0] = 15.6366359903591;
   fWeightMatrix0to1[2][0] = 2.64858937989666;
   fWeightMatrix0to1[3][0] = 0.128227915798733;
   fWeightMatrix0to1[4][0] = -1.497405596137;
   fWeightMatrix0to1[5][0] = -5.05341540645806;
   fWeightMatrix0to1[6][0] = -1.70005417156784;
   fWeightMatrix0to1[7][0] = 1.57962312910472;
   fWeightMatrix0to1[8][0] = -4.2225801761737;
   fWeightMatrix0to1[9][0] = -0.86547024199212;
   fWeightMatrix0to1[10][0] = -1.01219157288986;
   fWeightMatrix0to1[11][0] = -0.510557395611365;
   fWeightMatrix0to1[0][1] = -21.8180862717462;
   fWeightMatrix0to1[1][1] = -2.21630184716743;
   fWeightMatrix0to1[2][1] = 3.65297448792504;
   fWeightMatrix0to1[3][1] = 1.71950005165325;
   fWeightMatrix0to1[4][1] = -14.7529057945451;
   fWeightMatrix0to1[5][1] = 4.18514063611899;
   fWeightMatrix0to1[6][1] = -4.06004834148585;
   fWeightMatrix0to1[7][1] = 0.494040494728996;
   fWeightMatrix0to1[8][1] = 14.1445189067286;
   fWeightMatrix0to1[9][1] = -2.45223932151129;
   fWeightMatrix0to1[10][1] = 0.732754008264207;
   fWeightMatrix0to1[11][1] = -0.454890583160742;
   fWeightMatrix0to1[0][2] = 3.25571692560663;
   fWeightMatrix0to1[1][2] = 18.2113299047158;
   fWeightMatrix0to1[2][2] = 3.64116258008314;
   fWeightMatrix0to1[3][2] = 1.32944552080144;
   fWeightMatrix0to1[4][2] = -1.45028186197291;
   fWeightMatrix0to1[5][2] = -5.56627660004126;
   fWeightMatrix0to1[6][2] = -3.85456677604296;
   fWeightMatrix0to1[7][2] = 3.49170224417596;
   fWeightMatrix0to1[8][2] = -5.75679534405227;
   fWeightMatrix0to1[9][2] = -0.252649829316038;
   fWeightMatrix0to1[10][2] = -0.258591296315697;
   fWeightMatrix0to1[11][2] = -0.762109537830756;
   fWeightMatrix0to1[0][3] = -13.8989082501457;
   fWeightMatrix0to1[1][3] = -12.4301031620618;
   fWeightMatrix0to1[2][3] = -1.0844657557937;
   fWeightMatrix0to1[3][3] = 1.70725586930542;
   fWeightMatrix0to1[4][3] = 17.2230278525893;
   fWeightMatrix0to1[5][3] = 13.3375555742585;
   fWeightMatrix0to1[6][3] = 9.21469284451396;
   fWeightMatrix0to1[7][3] = -0.483870461692512;
   fWeightMatrix0to1[8][3] = -4.13758781445702;
   fWeightMatrix0to1[9][3] = -6.94257112711624;
   fWeightMatrix0to1[10][3] = -0.260589436573378;
   fWeightMatrix0to1[11][3] = -0.63950977753383;
   fWeightMatrix0to1[0][4] = 4.6311493219781;
   fWeightMatrix0to1[1][4] = 19.4815841593921;
   fWeightMatrix0to1[2][4] = 5.29668756754044;
   fWeightMatrix0to1[3][4] = 3.65872222941503;
   fWeightMatrix0to1[4][4] = -1.2732104974334;
   fWeightMatrix0to1[5][4] = -4.89357852889775;
   fWeightMatrix0to1[6][4] = -4.89422116735335;
   fWeightMatrix0to1[7][4] = 1.98995769676296;
   fWeightMatrix0to1[8][4] = -6.27418334251032;
   fWeightMatrix0to1[9][4] = -1.18154971155208;
   fWeightMatrix0to1[10][4] = 1.00139958803066;
   fWeightMatrix0to1[11][4] = 0.422454142579519;
   fWeightMatrix0to1[0][5] = -14.8922757973028;
   fWeightMatrix0to1[1][5] = -11.2555049588746;
   fWeightMatrix0to1[2][5] = -1.06071640035567;
   fWeightMatrix0to1[3][5] = 1.09161634581789;
   fWeightMatrix0to1[4][5] = 17.2226558274828;
   fWeightMatrix0to1[5][5] = 12.9144167456541;
   fWeightMatrix0to1[6][5] = 9.5646269950571;
   fWeightMatrix0to1[7][5] = 0.466982275827198;
   fWeightMatrix0to1[8][5] = -5.35265199558924;
   fWeightMatrix0to1[9][5] = -6.02337030089071;
   fWeightMatrix0to1[10][5] = -2.13039229146788;
   fWeightMatrix0to1[11][5] = -1.18119181104711;
   fWeightMatrix0to1[0][6] = 16.3151883947172;
   fWeightMatrix0to1[1][6] = 1.4635301372034;
   fWeightMatrix0to1[2][6] = 0.267669355725884;
   fWeightMatrix0to1[3][6] = -1.00741241688032;
   fWeightMatrix0to1[4][6] = -25.3620548620067;
   fWeightMatrix0to1[5][6] = -12.7777591554343;
   fWeightMatrix0to1[6][6] = -9.89909249157322;
   fWeightMatrix0to1[7][6] = -1.08354555457442;
   fWeightMatrix0to1[8][6] = 15.3748579006138;
   fWeightMatrix0to1[9][6] = 8.17402757713014;
   fWeightMatrix0to1[10][6] = 1.93335683572744;
   fWeightMatrix0to1[11][6] = 0.0855310238535224;
   fWeightMatrix0to1[0][7] = -0.261411891956991;
   fWeightMatrix0to1[1][7] = -0.0461597509416637;
   fWeightMatrix0to1[2][7] = -0.153979650400373;
   fWeightMatrix0to1[3][7] = 0.891967521854544;
   fWeightMatrix0to1[4][7] = 0.0118936723983409;
   fWeightMatrix0to1[5][7] = -0.730875708576914;
   fWeightMatrix0to1[6][7] = 0.563316850861799;
   fWeightMatrix0to1[7][7] = 0.0318275039871925;
   fWeightMatrix0to1[8][7] = 0.241213626966059;
   fWeightMatrix0to1[9][7] = -1.08759950343958;
   fWeightMatrix0to1[10][7] = -0.618503944853361;
   fWeightMatrix0to1[11][7] = 1.52031495816813;
   fWeightMatrix0to1[0][8] = 10.947010545685;
   fWeightMatrix0to1[1][8] = -3.66905864580158;
   fWeightMatrix0to1[2][8] = 0.880962774305454;
   fWeightMatrix0to1[3][8] = 0.861831621634525;
   fWeightMatrix0to1[4][8] = -11.0817588059142;
   fWeightMatrix0to1[5][8] = -7.69840386512261;
   fWeightMatrix0to1[6][8] = -3.06694057859436;
   fWeightMatrix0to1[7][8] = 0.57213134773175;
   fWeightMatrix0to1[8][8] = 1.49557093142927;
   fWeightMatrix0to1[9][8] = 4.46122710607258;
   fWeightMatrix0to1[10][8] = -1.66195665498993;
   fWeightMatrix0to1[11][8] = 0.146915932638683;
   fWeightMatrix0to1[0][9] = 1.06210746532585;
   fWeightMatrix0to1[1][9] = 0.248765652455802;
   fWeightMatrix0to1[2][9] = 0.427403765432729;
   fWeightMatrix0to1[3][9] = -1.18904906706042;
   fWeightMatrix0to1[4][9] = 0.499286983442887;
   fWeightMatrix0to1[5][9] = 0.476023451131036;
   fWeightMatrix0to1[6][9] = -0.830279281432526;
   fWeightMatrix0to1[7][9] = 0.184508685612977;
   fWeightMatrix0to1[8][9] = -0.147201323518481;
   fWeightMatrix0to1[9][9] = 0.622759544832904;
   fWeightMatrix0to1[10][9] = 2.06561522887367;
   fWeightMatrix0to1[11][9] = -0.14447666854035;
   fWeightMatrix0to1[0][10] = 0.403728942051994;
   fWeightMatrix0to1[1][10] = 1.10554495203675;
   fWeightMatrix0to1[2][10] = -1.3906695617121;
   fWeightMatrix0to1[3][10] = -0.711509878761856;
   fWeightMatrix0to1[4][10] = 0.637243959441177;
   fWeightMatrix0to1[5][10] = 1.07460554405132;
   fWeightMatrix0to1[6][10] = 0.987336181080005;
   fWeightMatrix0to1[7][10] = -1.93095768272201;
   fWeightMatrix0to1[8][10] = 1.54779911708283;
   fWeightMatrix0to1[9][10] = 0.486512803786478;
   fWeightMatrix0to1[10][10] = 1.36917433931632;
   fWeightMatrix0to1[11][10] = -1.83427310542638;
   fWeightMatrix0to1[0][11] = 18.381194647776;
   fWeightMatrix0to1[1][11] = 1.71664849827865;
   fWeightMatrix0to1[2][11] = -2.35851766968279;
   fWeightMatrix0to1[3][11] = -1.16090310600594;
   fWeightMatrix0to1[4][11] = -30.4933208892519;
   fWeightMatrix0to1[5][11] = -19.0890218759996;
   fWeightMatrix0to1[6][11] = -16.5879647319177;
   fWeightMatrix0to1[7][11] = -1.29744119043745;
   fWeightMatrix0to1[8][11] = 22.3578839725074;
   fWeightMatrix0to1[9][11] = 10.0424709525058;
   fWeightMatrix0to1[10][11] = 2.83883107719529;
   fWeightMatrix0to1[11][11] = 1.07275308335491;
   fWeightMatrix0to1[0][12] = 3.16096468597493;
   fWeightMatrix0to1[1][12] = 27.5775440479965;
   fWeightMatrix0to1[2][12] = 6.78556202572126;
   fWeightMatrix0to1[3][12] = -0.387342536208821;
   fWeightMatrix0to1[4][12] = -50.8821486940467;
   fWeightMatrix0to1[5][12] = -25.0737608807069;
   fWeightMatrix0to1[6][12] = -24.4205377812685;
   fWeightMatrix0to1[7][12] = -0.45297451452424;
   fWeightMatrix0to1[8][12] = 28.5796296596266;
   fWeightMatrix0to1[9][12] = 8.91480352293233;
   fWeightMatrix0to1[10][12] = 2.02330643688518;
   fWeightMatrix0to1[11][12] = 0.137347974635256;
   // weight matrix from layer 1 to 2
   fWeightMatrix1to2[0][0] = 5.65086647130132;
   fWeightMatrix1to2[1][0] = 3.20641754591297;
   fWeightMatrix1to2[2][0] = -1.04977443252741;
   fWeightMatrix1to2[3][0] = -2.23818810695879;
   fWeightMatrix1to2[4][0] = 0.293902105557047;
   fWeightMatrix1to2[5][0] = -0.171946003062579;
   fWeightMatrix1to2[6][0] = 0.467603081332967;
   fWeightMatrix1to2[7][0] = 0.166475945897936;
   fWeightMatrix1to2[8][0] = 3.66569787158699;
   fWeightMatrix1to2[9][0] = -1.00507917571704;
   fWeightMatrix1to2[10][0] = -1.97743686915395;
   fWeightMatrix1to2[0][1] = -1.69705400968613;
   fWeightMatrix1to2[1][1] = -1.52326003424706;
   fWeightMatrix1to2[2][1] = 3.70227341307948;
   fWeightMatrix1to2[3][1] = 0.820281435076491;
   fWeightMatrix1to2[4][1] = -2.10981428639737;
   fWeightMatrix1to2[5][1] = 0.199168430713713;
   fWeightMatrix1to2[6][1] = 6.28406210101037;
   fWeightMatrix1to2[7][1] = 1.40770921753366;
   fWeightMatrix1to2[8][1] = -11.1801578694437;
   fWeightMatrix1to2[9][1] = 3.94267073787288;
   fWeightMatrix1to2[10][1] = -7.7932786374635;
   fWeightMatrix1to2[0][2] = -0.969455146550795;
   fWeightMatrix1to2[1][2] = -5.55755273828968;
   fWeightMatrix1to2[2][2] = -1.28479840190801;
   fWeightMatrix1to2[3][2] = 3.06386206158098;
   fWeightMatrix1to2[4][2] = 5.13138102580491;
   fWeightMatrix1to2[5][2] = -2.90973670443985;
   fWeightMatrix1to2[6][2] = 0.447274111787242;
   fWeightMatrix1to2[7][2] = 0.834842688488963;
   fWeightMatrix1to2[8][2] = -4.64285502190778;
   fWeightMatrix1to2[9][2] = -0.923386873090262;
   fWeightMatrix1to2[10][2] = -2.16405217809659;
   fWeightMatrix1to2[0][3] = -0.817099660078374;
   fWeightMatrix1to2[1][3] = -1.4260035897412;
   fWeightMatrix1to2[2][3] = -0.76290786269583;
   fWeightMatrix1to2[3][3] = 4.39754282266184;
   fWeightMatrix1to2[4][3] = 2.13429124660287;
   fWeightMatrix1to2[5][3] = -1.25117770615964;
   fWeightMatrix1to2[6][3] = -0.788931645575183;
   fWeightMatrix1to2[7][3] = -1.61129179664713;
   fWeightMatrix1to2[8][3] = 0.925973692264711;
   fWeightMatrix1to2[9][3] = -1.40420771868219;
   fWeightMatrix1to2[10][3] = -1.54602297877224;
   fWeightMatrix1to2[0][4] = -3.14162885630565;
   fWeightMatrix1to2[1][4] = 0.857953008773577;
   fWeightMatrix1to2[2][4] = 1.64166650489776;
   fWeightMatrix1to2[3][4] = 2.08000920207083;
   fWeightMatrix1to2[4][4] = 5.47130432553851;
   fWeightMatrix1to2[5][4] = 9.756521871457;
   fWeightMatrix1to2[6][4] = -6.52519410006166;
   fWeightMatrix1to2[7][4] = -1.85516836568884;
   fWeightMatrix1to2[8][4] = 1.84032558599518;
   fWeightMatrix1to2[9][4] = -4.25625050947135;
   fWeightMatrix1to2[10][4] = 1.65133833880804;
   fWeightMatrix1to2[0][5] = -4.9864905505031;
   fWeightMatrix1to2[1][5] = -7.63681452825268;
   fWeightMatrix1to2[2][5] = 1.7157961494618;
   fWeightMatrix1to2[3][5] = 1.06904528257396;
   fWeightMatrix1to2[4][5] = 1.87608241100619;
   fWeightMatrix1to2[5][5] = 0.00150846013968115;
   fWeightMatrix1to2[6][5] = -3.38758368373446;
   fWeightMatrix1to2[7][5] = 1.2497020383732;
   fWeightMatrix1to2[8][5] = -1.3513340877756;
   fWeightMatrix1to2[9][5] = -1.95687135006127;
   fWeightMatrix1to2[10][5] = 4.91475638531081;
   fWeightMatrix1to2[0][6] = -1.89372370129749;
   fWeightMatrix1to2[1][6] = -0.0212567035707068;
   fWeightMatrix1to2[2][6] = 0.648352602795142;
   fWeightMatrix1to2[3][6] = 0.873053250045514;
   fWeightMatrix1to2[4][6] = 2.31370456150293;
   fWeightMatrix1to2[5][6] = 3.19434885104319;
   fWeightMatrix1to2[6][6] = -5.52439353658439;
   fWeightMatrix1to2[7][6] = -2.14744545022897;
   fWeightMatrix1to2[8][6] = 3.26162046403008;
   fWeightMatrix1to2[9][6] = -2.44770716135536;
   fWeightMatrix1to2[10][6] = 1.63418570025698;
   fWeightMatrix1to2[0][7] = -1.75196050448221;
   fWeightMatrix1to2[1][7] = 0.625232120631567;
   fWeightMatrix1to2[2][7] = -3.23699774857349;
   fWeightMatrix1to2[3][7] = 1.95448256957913;
   fWeightMatrix1to2[4][7] = 1.31716278313388;
   fWeightMatrix1to2[5][7] = -1.70594686361917;
   fWeightMatrix1to2[6][7] = -0.195451982793941;
   fWeightMatrix1to2[7][7] = -1.68115389464888;
   fWeightMatrix1to2[8][7] = -0.647341251976774;
   fWeightMatrix1to2[9][7] = -3.78533517213262;
   fWeightMatrix1to2[10][7] = -1.98048373602143;
   fWeightMatrix1to2[0][8] = 0.521458842383049;
   fWeightMatrix1to2[1][8] = 1.68185522890558;
   fWeightMatrix1to2[2][8] = -2.92393762094217;
   fWeightMatrix1to2[3][8] = -2.31827919595019;
   fWeightMatrix1to2[4][8] = -0.369997026821072;
   fWeightMatrix1to2[5][8] = -10.3068342487494;
   fWeightMatrix1to2[6][8] = 4.10676892279096;
   fWeightMatrix1to2[7][8] = -2.76639706915516;
   fWeightMatrix1to2[8][8] = -1.78876769926716;
   fWeightMatrix1to2[9][8] = 3.03497109207647;
   fWeightMatrix1to2[10][8] = 4.68011099464024;
   fWeightMatrix1to2[0][9] = 5.4363369903613;
   fWeightMatrix1to2[1][9] = 2.04681387335897;
   fWeightMatrix1to2[2][9] = -2.38365769225484;
   fWeightMatrix1to2[3][9] = -1.48640250185336;
   fWeightMatrix1to2[4][9] = -4.98100933065003;
   fWeightMatrix1to2[5][9] = -1.62652465829833;
   fWeightMatrix1to2[6][9] = 0.888921211868953;
   fWeightMatrix1to2[7][9] = 0.743398832089399;
   fWeightMatrix1to2[8][9] = 4.26110418287516;
   fWeightMatrix1to2[9][9] = 2.21743438872007;
   fWeightMatrix1to2[10][9] = -0.624489581622789;
   fWeightMatrix1to2[0][10] = -0.282535616044258;
   fWeightMatrix1to2[1][10] = 1.1769861196162;
   fWeightMatrix1to2[2][10] = 0.571461288565077;
   fWeightMatrix1to2[3][10] = -1.85814247253928;
   fWeightMatrix1to2[4][10] = -1.47352352202509;
   fWeightMatrix1to2[5][10] = -1.04317523171965;
   fWeightMatrix1to2[6][10] = 3.0455617020631;
   fWeightMatrix1to2[7][10] = 0.190698862586848;
   fWeightMatrix1to2[8][10] = -1.67525921008501;
   fWeightMatrix1to2[9][10] = 1.41529397960833;
   fWeightMatrix1to2[10][10] = 0.306408945935192;
   fWeightMatrix1to2[0][11] = 0.628723386063805;
   fWeightMatrix1to2[1][11] = -0.721674139078323;
   fWeightMatrix1to2[2][11] = 0.606621422899333;
   fWeightMatrix1to2[3][11] = -2.09870894934367;
   fWeightMatrix1to2[4][11] = -3.16348419407163;
   fWeightMatrix1to2[5][11] = -2.28909703578258;
   fWeightMatrix1to2[6][11] = 1.75176218015067;
   fWeightMatrix1to2[7][11] = -2.51875379074548;
   fWeightMatrix1to2[8][11] = 2.68987113385923;
   fWeightMatrix1to2[9][11] = -2.60893017356358;
   fWeightMatrix1to2[10][11] = 1.14903605829712;
   fWeightMatrix1to2[0][12] = -2.46815159228498;
   fWeightMatrix1to2[1][12] = -1.83904059261414;
   fWeightMatrix1to2[2][12] = -1.42003077247038;
   fWeightMatrix1to2[3][12] = 0.54611467805201;
   fWeightMatrix1to2[4][12] = -4.4971802635021;
   fWeightMatrix1to2[5][12] = -0.977534422493997;
   fWeightMatrix1to2[6][12] = 1.71818241900915;
   fWeightMatrix1to2[7][12] = -2.94136760989305;
   fWeightMatrix1to2[8][12] = 4.44459629500168;
   fWeightMatrix1to2[9][12] = -0.226352164528435;
   fWeightMatrix1to2[10][12] = -1.71358378985782;
   // weight matrix from layer 2 to 3
   fWeightMatrix2to3[0][0] = 1.38430546828428;
   fWeightMatrix2to3[1][0] = -1.37262801786812;
   fWeightMatrix2to3[2][0] = -0.286280862253075;
   fWeightMatrix2to3[3][0] = 0.315793206019274;
   fWeightMatrix2to3[4][0] = -0.598181218609001;
   fWeightMatrix2to3[5][0] = -1.01575952901218;
   fWeightMatrix2to3[6][0] = -0.87385449465539;
   fWeightMatrix2to3[7][0] = -2.87799516322011;
   fWeightMatrix2to3[8][0] = -2.19806057055115;
   fWeightMatrix2to3[9][0] = -0.954703269138835;
   fWeightMatrix2to3[10][0] = -2.63408819875028;
   fWeightMatrix2to3[11][0] = 1.97901437185378;
   fWeightMatrix2to3[12][0] = -1.48691565318152;
   fWeightMatrix2to3[13][0] = -1.50455713572753;
   fWeightMatrix2to3[14][0] = 3.27227468012495;
   fWeightMatrix2to3[15][0] = 0.346030893483536;
   fWeightMatrix2to3[16][0] = 1.08488122056882;
   fWeightMatrix2to3[17][0] = 2.2556590696922;
   fWeightMatrix2to3[18][0] = -1.75949161723332;
   fWeightMatrix2to3[19][0] = -0.371433015715006;
   fWeightMatrix2to3[20][0] = 1.16605625836943;
   fWeightMatrix2to3[21][0] = -1.83664021022117;
   fWeightMatrix2to3[0][1] = 1.66891417973021;
   fWeightMatrix2to3[1][1] = 0.420416635999055;
   fWeightMatrix2to3[2][1] = -0.693504029132175;
   fWeightMatrix2to3[3][1] = -0.500360622070316;
   fWeightMatrix2to3[4][1] = 1.52683833753972;
   fWeightMatrix2to3[5][1] = 1.71524987022499;
   fWeightMatrix2to3[6][1] = 2.69916296825482;
   fWeightMatrix2to3[7][1] = -3.03155917513561;
   fWeightMatrix2to3[8][1] = -0.034772586872245;
   fWeightMatrix2to3[9][1] = -2.43448280781117;
   fWeightMatrix2to3[10][1] = -0.590284574025712;
   fWeightMatrix2to3[11][1] = -2.27351838050414;
   fWeightMatrix2to3[12][1] = -1.84095582559429;
   fWeightMatrix2to3[13][1] = -0.81468000302237;
   fWeightMatrix2to3[14][1] = 3.7708979208494;
   fWeightMatrix2to3[15][1] = 0.03404366064378;
   fWeightMatrix2to3[16][1] = 4.27498827562515;
   fWeightMatrix2to3[17][1] = 0.823973367885205;
   fWeightMatrix2to3[18][1] = -0.157956546772665;
   fWeightMatrix2to3[19][1] = -1.8113431780802;
   fWeightMatrix2to3[20][1] = 0.375313016310904;
   fWeightMatrix2to3[21][1] = 1.23787993194116;
   fWeightMatrix2to3[0][2] = -5.01446280236441;
   fWeightMatrix2to3[1][2] = -0.274277324646692;
   fWeightMatrix2to3[2][2] = -1.30196407736883;
   fWeightMatrix2to3[3][2] = -0.704784911693362;
   fWeightMatrix2to3[4][2] = -1.52565188993993;
   fWeightMatrix2to3[5][2] = 1.34718786440363;
   fWeightMatrix2to3[6][2] = -0.749484791431459;
   fWeightMatrix2to3[7][2] = 1.36243697439112;
   fWeightMatrix2to3[8][2] = 1.58628430447233;
   fWeightMatrix2to3[9][2] = 1.40706823992709;
   fWeightMatrix2to3[10][2] = -0.416376393415005;
   fWeightMatrix2to3[11][2] = -2.52202125433109;
   fWeightMatrix2to3[12][2] = -1.64119409220696;
   fWeightMatrix2to3[13][2] = -0.910402226894097;
   fWeightMatrix2to3[14][2] = -0.112115585121978;
   fWeightMatrix2to3[15][2] = -0.895106316967878;
   fWeightMatrix2to3[16][2] = -0.0219439503590441;
   fWeightMatrix2to3[17][2] = 0.793026981794149;
   fWeightMatrix2to3[18][2] = -1.62761702615719;
   fWeightMatrix2to3[19][2] = -1.78215006045769;
   fWeightMatrix2to3[20][2] = -2.28584445073667;
   fWeightMatrix2to3[21][2] = 0.916236481118035;
   fWeightMatrix2to3[0][3] = -3.8745142161071;
   fWeightMatrix2to3[1][3] = -2.57357100385938;
   fWeightMatrix2to3[2][3] = -1.60272708232945;
   fWeightMatrix2to3[3][3] = -1.06721100115315;
   fWeightMatrix2to3[4][3] = -3.71688828070433;
   fWeightMatrix2to3[5][3] = -1.88891560563896;
   fWeightMatrix2to3[6][3] = -1.40611242980665;
   fWeightMatrix2to3[7][3] = -2.70405025144452;
   fWeightMatrix2to3[8][3] = 1.59621660199109;
   fWeightMatrix2to3[9][3] = -0.662130470857479;
   fWeightMatrix2to3[10][3] = -0.167908971008237;
   fWeightMatrix2to3[11][3] = 0.944771137031492;
   fWeightMatrix2to3[12][3] = 0.217322735055458;
   fWeightMatrix2to3[13][3] = 1.48219280687819;
   fWeightMatrix2to3[14][3] = -2.39375683075218;
   fWeightMatrix2to3[15][3] = -1.01530430259728;
   fWeightMatrix2to3[16][3] = -2.9962067839478;
   fWeightMatrix2to3[17][3] = -3.56033761623826;
   fWeightMatrix2to3[18][3] = 0.574553209102931;
   fWeightMatrix2to3[19][3] = 0.834639760292565;
   fWeightMatrix2to3[20][3] = -1.06115735391622;
   fWeightMatrix2to3[21][3] = 0.195551908499731;
   fWeightMatrix2to3[0][4] = 0.0360443155551781;
   fWeightMatrix2to3[1][4] = 1.91308460477814;
   fWeightMatrix2to3[2][4] = -1.77895776846101;
   fWeightMatrix2to3[3][4] = 1.80479015254628;
   fWeightMatrix2to3[4][4] = 0.0571164333598215;
   fWeightMatrix2to3[5][4] = -4.66528281630297;
   fWeightMatrix2to3[6][4] = -1.17113746803365;
   fWeightMatrix2to3[7][4] = -1.64823480167537;
   fWeightMatrix2to3[8][4] = 0.73464565683241;
   fWeightMatrix2to3[9][4] = 0.688707265747706;
   fWeightMatrix2to3[10][4] = 1.75089446222875;
   fWeightMatrix2to3[11][4] = 3.48086089634778;
   fWeightMatrix2to3[12][4] = -1.24779434701786;
   fWeightMatrix2to3[13][4] = 2.32025971187781;
   fWeightMatrix2to3[14][4] = -0.938460029031605;
   fWeightMatrix2to3[15][4] = -0.264454717639324;
   fWeightMatrix2to3[16][4] = -2.74313591364001;
   fWeightMatrix2to3[17][4] = 0.135258604363064;
   fWeightMatrix2to3[18][4] = -2.16264230460164;
   fWeightMatrix2to3[19][4] = 1.51558555766691;
   fWeightMatrix2to3[20][4] = 0.0430536261578205;
   fWeightMatrix2to3[21][4] = -0.2936716326636;
   fWeightMatrix2to3[0][5] = -1.43220917419574;
   fWeightMatrix2to3[1][5] = -1.60875677400909;
   fWeightMatrix2to3[2][5] = -1.5256022102209;
   fWeightMatrix2to3[3][5] = 0.201271811125663;
   fWeightMatrix2to3[4][5] = -3.10737369690316;
   fWeightMatrix2to3[5][5] = -1.65236545304427;
   fWeightMatrix2to3[6][5] = -0.329612071112755;
   fWeightMatrix2to3[7][5] = 2.86728272415805;
   fWeightMatrix2to3[8][5] = 2.86222789815808;
   fWeightMatrix2to3[9][5] = 4.73763635219841;
   fWeightMatrix2to3[10][5] = 0.38283385910908;
   fWeightMatrix2to3[11][5] = -1.21354228672695;
   fWeightMatrix2to3[12][5] = 0.0598027412723972;
   fWeightMatrix2to3[13][5] = 2.68582538123654;
   fWeightMatrix2to3[14][5] = -3.18625133812267;
   fWeightMatrix2to3[15][5] = -1.53580192546845;
   fWeightMatrix2to3[16][5] = -1.54866020242298;
   fWeightMatrix2to3[17][5] = -2.22665669215859;
   fWeightMatrix2to3[18][5] = -1.64920864559899;
   fWeightMatrix2to3[19][5] = -1.56080289436593;
   fWeightMatrix2to3[20][5] = -0.454846858707398;
   fWeightMatrix2to3[21][5] = 0.695600888156354;
   fWeightMatrix2to3[0][6] = -3.41212053890262;
   fWeightMatrix2to3[1][6] = -1.78401114485996;
   fWeightMatrix2to3[2][6] = -0.276056937957708;
   fWeightMatrix2to3[3][6] = -0.674072084857483;
   fWeightMatrix2to3[4][6] = -0.0693741369056096;
   fWeightMatrix2to3[5][6] = 2.76022468945631;
   fWeightMatrix2to3[6][6] = -0.07410915456053;
   fWeightMatrix2to3[7][6] = -2.22647659044352;
   fWeightMatrix2to3[8][6] = -1.76995168380733;
   fWeightMatrix2to3[9][6] = -3.85633712860772;
   fWeightMatrix2to3[10][6] = -2.04975623738061;
   fWeightMatrix2to3[11][6] = -1.01676178500456;
   fWeightMatrix2to3[12][6] = -0.616049728732305;
   fWeightMatrix2to3[13][6] = -1.81130940194275;
   fWeightMatrix2to3[14][6] = 2.33093693694972;
   fWeightMatrix2to3[15][6] = -0.0749967781821055;
   fWeightMatrix2to3[16][6] = 1.89207364273553;
   fWeightMatrix2to3[17][6] = -0.921116042667463;
   fWeightMatrix2to3[18][6] = -0.732400042100656;
   fWeightMatrix2to3[19][6] = -1.32375445632401;
   fWeightMatrix2to3[20][6] = -1.89110460706886;
   fWeightMatrix2to3[21][6] = -2.14447568995741;
   fWeightMatrix2to3[0][7] = 1.74880212805287;
   fWeightMatrix2to3[1][7] = 1.88038616840173;
   fWeightMatrix2to3[2][7] = -0.938983509470529;
   fWeightMatrix2to3[3][7] = 1.29711239268346;
   fWeightMatrix2to3[4][7] = -2.42726911171686;
   fWeightMatrix2to3[5][7] = 1.10460327020167;
   fWeightMatrix2to3[6][7] = 1.39209417170526;
   fWeightMatrix2to3[7][7] = -0.655256764269419;
   fWeightMatrix2to3[8][7] = 0.253241196014626;
   fWeightMatrix2to3[9][7] = 0.72408874323616;
   fWeightMatrix2to3[10][7] = -0.292511375826673;
   fWeightMatrix2to3[11][7] = 1.59057654615532;
   fWeightMatrix2to3[12][7] = -0.0957644581976238;
   fWeightMatrix2to3[13][7] = -0.403498145738293;
   fWeightMatrix2to3[14][7] = -2.34717089734532;
   fWeightMatrix2to3[15][7] = 0.0661231123299359;
   fWeightMatrix2to3[16][7] = 0.833380179330145;
   fWeightMatrix2to3[17][7] = 0.0572361592549092;
   fWeightMatrix2to3[18][7] = -0.741470782453515;
   fWeightMatrix2to3[19][7] = -1.9033736108078;
   fWeightMatrix2to3[20][7] = 1.53875641810252;
   fWeightMatrix2to3[21][7] = 0.516959880241669;
   fWeightMatrix2to3[0][8] = 0.736844316248788;
   fWeightMatrix2to3[1][8] = 1.62497313369786;
   fWeightMatrix2to3[2][8] = -0.768253183998977;
   fWeightMatrix2to3[3][8] = -0.430870909080316;
   fWeightMatrix2to3[4][8] = -0.148528441636713;
   fWeightMatrix2to3[5][8] = -4.79626207918087;
   fWeightMatrix2to3[6][8] = -4.17339706364992;
   fWeightMatrix2to3[7][8] = 3.74885444071948;
   fWeightMatrix2to3[8][8] = 0.932808033687301;
   fWeightMatrix2to3[9][8] = 3.65821976969351;
   fWeightMatrix2to3[10][8] = 1.54704705357644;
   fWeightMatrix2to3[11][8] = -1.389679091811;
   fWeightMatrix2to3[12][8] = -1.36499738610197;
   fWeightMatrix2to3[13][8] = 2.31839665515003;
   fWeightMatrix2to3[14][8] = -1.58256757054318;
   fWeightMatrix2to3[15][8] = -0.087395735192542;
   fWeightMatrix2to3[16][8] = -3.19636437953575;
   fWeightMatrix2to3[17][8] = -1.18926027588297;
   fWeightMatrix2to3[18][8] = -1.96963739224218;
   fWeightMatrix2to3[19][8] = -0.111757531527313;
   fWeightMatrix2to3[20][8] = -4.02304941813608;
   fWeightMatrix2to3[21][8] = 1.00584975463099;
   fWeightMatrix2to3[0][9] = -2.5764367214044;
   fWeightMatrix2to3[1][9] = 1.49763243735721;
   fWeightMatrix2to3[2][9] = 1.04679888418826;
   fWeightMatrix2to3[3][9] = -3.47590630544004;
   fWeightMatrix2to3[4][9] = 2.14041414199925;
   fWeightMatrix2to3[5][9] = 1.74936616168915;
   fWeightMatrix2to3[6][9] = 1.58552862399989;
   fWeightMatrix2to3[7][9] = -0.880041916313601;
   fWeightMatrix2to3[8][9] = -2.49915175372986;
   fWeightMatrix2to3[9][9] = 0.995980982424791;
   fWeightMatrix2to3[10][9] = -2.0821331855194;
   fWeightMatrix2to3[11][9] = -0.869939357754049;
   fWeightMatrix2to3[12][9] = -1.41977845265215;
   fWeightMatrix2to3[13][9] = -0.392338359110491;
   fWeightMatrix2to3[14][9] = -4.34997866610887;
   fWeightMatrix2to3[15][9] = -0.115827207880648;
   fWeightMatrix2to3[16][9] = -2.1306459910851;
   fWeightMatrix2to3[17][9] = -0.537669778407614;
   fWeightMatrix2to3[18][9] = -0.353198056276645;
   fWeightMatrix2to3[19][9] = -2.54339234978319;
   fWeightMatrix2to3[20][9] = 0.679549764779058;
   fWeightMatrix2to3[21][9] = -1.136535227424;
   fWeightMatrix2to3[0][10] = 5.80735923771087;
   fWeightMatrix2to3[1][10] = 2.26352281236749;
   fWeightMatrix2to3[2][10] = -1.92757772586008;
   fWeightMatrix2to3[3][10] = 1.11696959002436;
   fWeightMatrix2to3[4][10] = -3.90817220593001;
   fWeightMatrix2to3[5][10] = -0.831869951759438;
   fWeightMatrix2to3[6][10] = 1.69446695962115;
   fWeightMatrix2to3[7][10] = -1.20728325775594;
   fWeightMatrix2to3[8][10] = 0.482682397175772;
   fWeightMatrix2to3[9][10] = 2.78081156259079;
   fWeightMatrix2to3[10][10] = -1.945085590547;
   fWeightMatrix2to3[11][10] = -2.55914279862594;
   fWeightMatrix2to3[12][10] = -1.12113720652185;
   fWeightMatrix2to3[13][10] = -0.425085271376911;
   fWeightMatrix2to3[14][10] = -2.72667139366523;
   fWeightMatrix2to3[15][10] = -0.467407864399576;
   fWeightMatrix2to3[16][10] = -2.43238206149137;
   fWeightMatrix2to3[17][10] = -1.6944184924536;
   fWeightMatrix2to3[18][10] = -0.851956734985074;
   fWeightMatrix2to3[19][10] = -0.487398978991318;
   fWeightMatrix2to3[20][10] = -2.20981743141015;
   fWeightMatrix2to3[21][10] = -0.782848324552774;
   fWeightMatrix2to3[0][11] = -1.70043289462207;
   fWeightMatrix2to3[1][11] = -2.40534354903086;
   fWeightMatrix2to3[2][11] = -1.91245771643138;
   fWeightMatrix2to3[3][11] = -2.32453531643891;
   fWeightMatrix2to3[4][11] = -2.0098226077613;
   fWeightMatrix2to3[5][11] = -2.57123128987338;
   fWeightMatrix2to3[6][11] = -1.78155546401774;
   fWeightMatrix2to3[7][11] = -2.52129983258431;
   fWeightMatrix2to3[8][11] = -3.75350005968206;
   fWeightMatrix2to3[9][11] = -2.07992016977947;
   fWeightMatrix2to3[10][11] = -0.731586034036689;
   fWeightMatrix2to3[11][11] = -3.75058463949059;
   fWeightMatrix2to3[12][11] = -1.92222203349998;
   fWeightMatrix2to3[13][11] = -2.26509335351415;
   fWeightMatrix2to3[14][11] = -3.76867327628906;
   fWeightMatrix2to3[15][11] = -2.09249809153184;
   fWeightMatrix2to3[16][11] = -1.67355442079959;
   fWeightMatrix2to3[17][11] = -0.00749473288193897;
   fWeightMatrix2to3[18][11] = -1.78343973600161;
   fWeightMatrix2to3[19][11] = -1.06567364258771;
   fWeightMatrix2to3[20][11] = -0.611536552462265;
   fWeightMatrix2to3[21][11] = -1.5827508307677;
   // weight matrix from layer 3 to 4
   fWeightMatrix3to4[0][0] = 6.29519295683277;
   fWeightMatrix3to4[0][1] = 0.511946474539087;
   fWeightMatrix3to4[0][2] = -1.12195120115021;
   fWeightMatrix3to4[0][3] = 0.965927578068513;
   fWeightMatrix3to4[0][4] = -1.93886942650807;
   fWeightMatrix3to4[0][5] = -1.69446206611228;
   fWeightMatrix3to4[0][6] = -2.12699201117386;
   fWeightMatrix3to4[0][7] = 2.19478615745119;
   fWeightMatrix3to4[0][8] = 1.8947939422866;
   fWeightMatrix3to4[0][9] = 2.7974339535743;
   fWeightMatrix3to4[0][10] = 1.0895733407574;
   fWeightMatrix3to4[0][11] = 2.57699316893535;
   fWeightMatrix3to4[0][12] = -0.264126751337887;
   fWeightMatrix3to4[0][13] = 1.72332065504232;
   fWeightMatrix3to4[0][14] = -5.40827382054185;
   fWeightMatrix3to4[0][15] = -0.833315461641104;
   fWeightMatrix3to4[0][16] = -3.68924612562194;
   fWeightMatrix3to4[0][17] = -1.83760092033082;
   fWeightMatrix3to4[0][18] = -0.803491628565789;
   fWeightMatrix3to4[0][19] = 1.55371935595002;
   fWeightMatrix3to4[0][20] = -0.448687275568039;
   fWeightMatrix3to4[0][21] = 0.822742050592838;
   fWeightMatrix3to4[0][22] = 1.11490495108276;
}

inline double ReadMLP3::GetMvaValue__( const std::vector<double>& inputValues ) const
{
   if (inputValues.size() != (unsigned int)12) {
      std::cout << "Input vector needs to be of size " << 12 << std::endl;
      return 0;
   }

   std::array<double, 13> fWeights1 {{}};
   std::array<double, 12> fWeights2 {{}};
   std::array<double, 23> fWeights3 {{}};
   std::array<double, 1> fWeights4 {{}};
   fWeights1.back() = 1.;
   fWeights2.back() = 1.;
   fWeights3.back() = 1.;

   // layer 0 to 1
   for (int o=0; o<12; o++) {
      std::array<double, 13> buffer; // no need to initialise
      for (int i = 0; i<13 - 1; i++) {
         buffer[i] = fWeightMatrix0to1[o][i] * inputValues[i];
      } // loop over i
      buffer.back() = fWeightMatrix0to1[o][12];
      for (int i=0; i<13; i++) {
         fWeights1[o] += buffer[i];
      } // loop over i
    } // loop over o
   for (int o=0; o<12; o++) {
      fWeights1[o] = ActivationFnc(fWeights1[o]);
   } // loop over o
   // layer 1 to 2
   for (int o=0; o<11; o++) {
      std::array<double, 13> buffer; // no need to initialise
      for (int i=0; i<13; i++) {
         buffer[i] = fWeightMatrix1to2[o][i] * fWeights1[i];
      } // loop over i
      for (int i=0; i<13; i++) {
         fWeights2[o] += buffer[i];
      } // loop over i
    } // loop over o
   for (int o=0; o<11; o++) {
      fWeights2[o] = ActivationFnc(fWeights2[o]);
   } // loop over o
   // layer 2 to 3
   for (int o=0; o<22; o++) {
      std::array<double, 12> buffer; // no need to initialise
      for (int i=0; i<12; i++) {
         buffer[i] = fWeightMatrix2to3[o][i] * fWeights2[i];
      } // loop over i
      for (int i=0; i<12; i++) {
         fWeights3[o] += buffer[i];
      } // loop over i
    } // loop over o
   for (int o=0; o<22; o++) {
      fWeights3[o] = ActivationFnc(fWeights3[o]);
   } // loop over o
   // layer 3 to 4
   for (int o=0; o<1; o++) {
      std::array<double, 23> buffer; // no need to initialise
      for (int i=0; i<23; i++) {
         buffer[i] = fWeightMatrix3to4[o][i] * fWeights3[i];
      } // loop over i
      for (int i=0; i<23; i++) {
         fWeights4[o] += buffer[i];
      } // loop over i
    } // loop over o
   for (int o=0; o<1; o++) {
      fWeights4[o] = OutputActivationFnc(fWeights4[o]);
   } // loop over o

   return fWeights4[0];
}

double ReadMLP3::ActivationFnc(double x) const {
   // sigmoid
   return 1.0/(1.0+exp(-x));
}
double ReadMLP3::OutputActivationFnc(double x) const {
   // sigmoid
   return 1.0/(1.0+exp(-x));
}

// Clean up
inline void ReadMLP3::Clear()
{
}
inline double ReadMLP3::GetMvaValue( const std::vector<double>& inputValues ) const
{
   // classifier response value
   double retval = 0;

   // classifier response, sanity check first
   if (!IsStatusClean()) {
      std::cout << "Problem in class \"" << fClassName << "\": cannot return classifier response"
                << " because status is dirty" << std::endl;
   }
   else {
         std::vector<double> iV(inputValues);
         Transform( iV, -1 );
         retval = GetMvaValue__( iV );
   }

   return retval;
}

//_______________________________________________________________________
inline void ReadMLP3::InitTransform_1()
{
   double fMin_1[3][12];
   double fMax_1[3][12];
   // Normalization transformation, initialisation
   fMin_1[0][0] = 0.00790263805538;
   fMax_1[0][0] = 99.9529266357;
   fScal_1[0][0] = 2.0/(fMax_1[0][0]-fMin_1[0][0]);
   fOff_1[0][0] = fMin_1[0][0]*fScal_1[0][0]+1.;
   fMin_1[1][0] = 0.0545513182878;
   fMax_1[1][0] = 81.2540817261;
   fScal_1[1][0] = 2.0/(fMax_1[1][0]-fMin_1[1][0]);
   fOff_1[1][0] = fMin_1[1][0]*fScal_1[1][0]+1.;
   fMin_1[2][0] = 0.00790263805538;
   fMax_1[2][0] = 99.9529266357;
   fScal_1[2][0] = 2.0/(fMax_1[2][0]-fMin_1[2][0]);
   fOff_1[2][0] = fMin_1[2][0]*fScal_1[2][0]+1.;
   fMin_1[0][1] = 1.86867570877;
   fMax_1[0][1] = 78.8557510376;
   fScal_1[0][1] = 2.0/(fMax_1[0][1]-fMin_1[0][1]);
   fOff_1[0][1] = fMin_1[0][1]*fScal_1[0][1]+1.;
   fMin_1[1][1] = 1.8670412302;
   fMax_1[1][1] = 77.9447631836;
   fScal_1[1][1] = 2.0/(fMax_1[1][1]-fMin_1[1][1]);
   fOff_1[1][1] = fMin_1[1][1]*fScal_1[1][1]+1.;
   fMin_1[2][1] = 1.8670412302;
   fMax_1[2][1] = 78.8557510376;
   fScal_1[2][1] = 2.0/(fMax_1[2][1]-fMin_1[2][1]);
   fOff_1[2][1] = fMin_1[2][1]*fScal_1[2][1]+1.;
   fMin_1[0][2] = 0.00137880223338;
   fMax_1[0][2] = 75.2346725464;
   fScal_1[0][2] = 2.0/(fMax_1[0][2]-fMin_1[0][2]);
   fOff_1[0][2] = fMin_1[0][2]*fScal_1[0][2]+1.;
   fMin_1[1][2] = 0.0206296276301;
   fMax_1[1][2] = 65.1792068481;
   fScal_1[1][2] = 2.0/(fMax_1[1][2]-fMin_1[1][2]);
   fOff_1[1][2] = fMin_1[1][2]*fScal_1[1][2]+1.;
   fMin_1[2][2] = 0.00137880223338;
   fMax_1[2][2] = 75.2346725464;
   fScal_1[2][2] = 2.0/(fMax_1[2][2]-fMin_1[2][2]);
   fOff_1[2][2] = fMin_1[2][2]*fScal_1[2][2]+1.;
   fMin_1[0][3] = 0.139762371778;
   fMax_1[0][3] = 72.3301239014;
   fScal_1[0][3] = 2.0/(fMax_1[0][3]-fMin_1[0][3]);
   fOff_1[0][3] = fMin_1[0][3]*fScal_1[0][3]+1.;
   fMin_1[1][3] = 0.141273483634;
   fMax_1[1][3] = 59.949005127;
   fScal_1[1][3] = 2.0/(fMax_1[1][3]-fMin_1[1][3]);
   fOff_1[1][3] = fMin_1[1][3]*fScal_1[1][3]+1.;
   fMin_1[2][3] = 0.139762371778;
   fMax_1[2][3] = 72.3301239014;
   fScal_1[2][3] = 2.0/(fMax_1[2][3]-fMin_1[2][3]);
   fOff_1[2][3] = fMin_1[2][3]*fScal_1[2][3]+1.;
   fMin_1[0][4] = 0.00976904947311;
   fMax_1[0][4] = 92.3326873779;
   fScal_1[0][4] = 2.0/(fMax_1[0][4]-fMin_1[0][4]);
   fOff_1[0][4] = fMin_1[0][4]*fScal_1[0][4]+1.;
   fMin_1[1][4] = 0.0291006714106;
   fMax_1[1][4] = 77.6828460693;
   fScal_1[1][4] = 2.0/(fMax_1[1][4]-fMin_1[1][4]);
   fOff_1[1][4] = fMin_1[1][4]*fScal_1[1][4]+1.;
   fMin_1[2][4] = 0.00976904947311;
   fMax_1[2][4] = 92.3326873779;
   fScal_1[2][4] = 2.0/(fMax_1[2][4]-fMin_1[2][4]);
   fOff_1[2][4] = fMin_1[2][4]*fScal_1[2][4]+1.;
   fMin_1[0][5] = 0.494090646505;
   fMax_1[0][5] = 75.381477356;
   fScal_1[0][5] = 2.0/(fMax_1[0][5]-fMin_1[0][5]);
   fOff_1[0][5] = fMin_1[0][5]*fScal_1[0][5]+1.;
   fMin_1[1][5] = 0.494948774576;
   fMax_1[1][5] = 62.7810249329;
   fScal_1[1][5] = 2.0/(fMax_1[1][5]-fMin_1[1][5]);
   fOff_1[1][5] = fMin_1[1][5]*fScal_1[1][5]+1.;
   fMin_1[2][5] = 0.494090646505;
   fMax_1[2][5] = 75.381477356;
   fScal_1[2][5] = 2.0/(fMax_1[2][5]-fMin_1[2][5]);
   fOff_1[2][5] = fMin_1[2][5]*fScal_1[2][5]+1.;
   fMin_1[0][6] = 3.37924666383e-06;
   fMax_1[0][6] = 133.725830078;
   fScal_1[0][6] = 2.0/(fMax_1[0][6]-fMin_1[0][6]);
   fOff_1[0][6] = fMin_1[0][6]*fScal_1[0][6]+1.;
   fMin_1[1][6] = 0.00330413342454;
   fMax_1[1][6] = 181.935562134;
   fScal_1[1][6] = 2.0/(fMax_1[1][6]-fMin_1[1][6]);
   fOff_1[1][6] = fMin_1[1][6]*fScal_1[1][6]+1.;
   fMin_1[2][6] = 3.37924666383e-06;
   fMax_1[2][6] = 181.935562134;
   fScal_1[2][6] = 2.0/(fMax_1[2][6]-fMin_1[2][6]);
   fOff_1[2][6] = fMin_1[2][6]*fScal_1[2][6]+1.;
   fMin_1[0][7] = 3.84784243579e-06;
   fMax_1[0][7] = 0.999999940395;
   fScal_1[0][7] = 2.0/(fMax_1[0][7]-fMin_1[0][7]);
   fOff_1[0][7] = fMin_1[0][7]*fScal_1[0][7]+1.;
   fMin_1[1][7] = 1.28584670165e-05;
   fMax_1[1][7] = 0.999999821186;
   fScal_1[1][7] = 2.0/(fMax_1[1][7]-fMin_1[1][7]);
   fOff_1[1][7] = fMin_1[1][7]*fScal_1[1][7]+1.;
   fMin_1[2][7] = 3.84784243579e-06;
   fMax_1[2][7] = 0.999999940395;
   fScal_1[2][7] = 2.0/(fMax_1[2][7]-fMin_1[2][7]);
   fOff_1[2][7] = fMin_1[2][7]*fScal_1[2][7]+1.;
   fMin_1[0][8] = 3.32895024258e-06;
   fMax_1[0][8] = 82.4766464233;
   fScal_1[0][8] = 2.0/(fMax_1[0][8]-fMin_1[0][8]);
   fOff_1[0][8] = fMin_1[0][8]*fScal_1[0][8]+1.;
   fMin_1[1][8] = 0.000470213853987;
   fMax_1[1][8] = 126.578300476;
   fScal_1[1][8] = 2.0/(fMax_1[1][8]-fMin_1[1][8]);
   fOff_1[1][8] = fMin_1[1][8]*fScal_1[1][8]+1.;
   fMin_1[2][8] = 3.32895024258e-06;
   fMax_1[2][8] = 126.578300476;
   fScal_1[2][8] = 2.0/(fMax_1[2][8]-fMin_1[2][8]);
   fOff_1[2][8] = fMin_1[2][8]*fScal_1[2][8]+1.;
   fMin_1[0][9] = 0.00165389641188;
   fMax_1[0][9] = 1016.45672607;
   fScal_1[0][9] = 2.0/(fMax_1[0][9]-fMin_1[0][9]);
   fOff_1[0][9] = fMin_1[0][9]*fScal_1[0][9]+1.;
   fMin_1[1][9] = 0.0243833828717;
   fMax_1[1][9] = 1326.87768555;
   fScal_1[1][9] = 2.0/(fMax_1[1][9]-fMin_1[1][9]);
   fOff_1[1][9] = fMin_1[1][9]*fScal_1[1][9]+1.;
   fMin_1[2][9] = 0.00165389641188;
   fMax_1[2][9] = 1326.87768555;
   fScal_1[2][9] = 2.0/(fMax_1[2][9]-fMin_1[2][9]);
   fOff_1[2][9] = fMin_1[2][9]*fScal_1[2][9]+1.;
   fMin_1[0][10] = 0.00454952009022;
   fMax_1[0][10] = 1128.78234863;
   fScal_1[0][10] = 2.0/(fMax_1[0][10]-fMin_1[0][10]);
   fOff_1[0][10] = fMin_1[0][10]*fScal_1[0][10]+1.;
   fMin_1[1][10] = 0.0260292366147;
   fMax_1[1][10] = 1205.23425293;
   fScal_1[1][10] = 2.0/(fMax_1[1][10]-fMin_1[1][10]);
   fOff_1[1][10] = fMin_1[1][10]*fScal_1[1][10]+1.;
   fMin_1[2][10] = 0.00454952009022;
   fMax_1[2][10] = 1205.23425293;
   fScal_1[2][10] = 2.0/(fMax_1[2][10]-fMin_1[2][10]);
   fOff_1[2][10] = fMin_1[2][10]*fScal_1[2][10]+1.;
   fMin_1[0][11] = 5.07403183292e-06;
   fMax_1[0][11] = 128.711242676;
   fScal_1[0][11] = 2.0/(fMax_1[0][11]-fMin_1[0][11]);
   fOff_1[0][11] = fMin_1[0][11]*fScal_1[0][11]+1.;
   fMin_1[1][11] = 0.00238028890453;
   fMax_1[1][11] = 329.686035156;
   fScal_1[1][11] = 2.0/(fMax_1[1][11]-fMin_1[1][11]);
   fOff_1[1][11] = fMin_1[1][11]*fScal_1[1][11]+1.;
   fMin_1[2][11] = 5.07403183292e-06;
   fMax_1[2][11] = 329.686035156;
   fScal_1[2][11] = 2.0/(fMax_1[2][11]-fMin_1[2][11]);
   fOff_1[2][11] = fMin_1[2][11]*fScal_1[2][11]+1.;
}

//_______________________________________________________________________
inline void ReadMLP3::Transform_1( std::vector<double>& iv, int cls) const
{
   // Normalization transformation
   if (cls < 0 || cls > 2) {
   if (2 > 1 ) cls = 2;
      else cls = 2;
   }
   const int nVar = 12;

   // get indices of used variables

   // define the indices of the variables which are transformed by this transformation
   static std::vector<int> indicesGet;
   static std::vector<int> indicesPut;

   if ( indicesGet.empty() ) {
      indicesGet.reserve(fNvars);
      indicesGet.push_back( 0);
      indicesGet.push_back( 1);
      indicesGet.push_back( 2);
      indicesGet.push_back( 3);
      indicesGet.push_back( 4);
      indicesGet.push_back( 5);
      indicesGet.push_back( 6);
      indicesGet.push_back( 7);
      indicesGet.push_back( 8);
      indicesGet.push_back( 9);
      indicesGet.push_back( 10);
      indicesGet.push_back( 11);
   }
   if ( indicesPut.empty() ) {
      indicesPut.reserve(fNvars);
      indicesPut.push_back( 0);
      indicesPut.push_back( 1);
      indicesPut.push_back( 2);
      indicesPut.push_back( 3);
      indicesPut.push_back( 4);
      indicesPut.push_back( 5);
      indicesPut.push_back( 6);
      indicesPut.push_back( 7);
      indicesPut.push_back( 8);
      indicesPut.push_back( 9);
      indicesPut.push_back( 10);
      indicesPut.push_back( 11);
   }

   static std::vector<double> dv;
   dv.resize(nVar);
   for (int ivar=0; ivar<nVar; ivar++) dv[ivar] = iv[indicesGet.at(ivar)];
   for (int ivar=0;ivar<12;ivar++) {
      double offset = fOff_1[cls][ivar];
      double scale  = fScal_1[cls][ivar];
      iv[indicesPut.at(ivar)] = scale*dv[ivar]-offset;
   }
}

//_______________________________________________________________________
inline void ReadMLP3::InitTransform()
{
   InitTransform_1();
}

//_______________________________________________________________________
inline void ReadMLP3::Transform( std::vector<double>& iv, int sigOrBgd ) const
{
   Transform_1( iv, sigOrBgd );
}
